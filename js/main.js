$(document).ready(function () {
  $(".slick-slider").slick({
    centerMode: true,
    centerPadding: "200px",
    slidesToShow: 1,
    focusOnSelect: true,
    dots: false,
    autoplay: false,
    responsive: [
      {
        breakpoint: 1400,
        settings: {
          centerMode: true,
          centerPadding: "150px",
          slidesToShow: 1,
        },
      },
      {
        breakpoint: 743,
        settings: {
          centerMode: true,
          centerPadding: "100px",
          slidesToShow: 1,
        },
      },
      {
        breakpoint: 500,
        settings: {
          centerMode: true,
          centerPadding: "50px",
          slidesToShow: 1,
        },
      },
    ],
  });
});

$(document).ready(function () {
  $(".slick-slider-community_mobile").slick({
    centerMode: true,
    centerPadding: "200px",
    slidesToShow: 1,
    focusOnSelect: true,
    dots: true,
    autoplay: false,
    responsive: [
      {
        breakpoint: 1400,
        settings: {
          centerMode: true,
          centerPadding: "150px",
          slidesToShow: 1,
        },
      },
    ],
  });
});

$(document).ready(function () {
  $(".slick-slider_categories").slick({
    centerMode: true,
    centerPadding: "200px",
    slidesToShow: 1,
    focusOnSelect: true,
    dots: false,
    autoplay: true,
    responsive: [
      {
        breakpoint: 1400,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "150px",
          slidesToShow: 1,
        },
      },
    ],
  });
});

$(document).ready(function () {
  $(".slick-slider_categories2").slick({
    centerMode: true,
    centerPadding: "200px",
    slidesToShow: 1,
    focusOnSelect: true,
    dots: true,
    autoplay: false,
    responsive: [
      {
        breakpoint: 1400,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "150px",
          slidesToShow: 1,
        },
      },
    ],
  });
});

$(document).ready(function () {
  $(".slick-carousel-center").slick({
    centerMode: true,
    centerPadding: "160px",
    slidesToShow: 3,
    focusOnSelect: true,
    dots: false,
    infinite: true,
    autoplay: false,
    nav: true,
    responsive: [
      {
        breakpoint: 1400,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "71px",
          slidesToShow: 3,
        },
      },

      {
        breakpoint: 1200,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "30px",
          slidesToShow: 2,
        },
      },

      {
        breakpoint: 992,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "185px",
          slidesToShow: 1,
        },
      },

      {
        breakpoint: 768,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "95px",
          slidesToShow: 1,
        },
      },

      {
        breakpoint: 575,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "38px",
          slidesToShow: 1,
        },
      },

      {
        breakpoint: 425,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "13px",
          slidesToShow: 1,
        },
      },

      {
        breakpoint: 375,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "25px",
          slidesToShow: 1,
        },
      },
    ],
  });
});

$(document).ready(function () {
  $(".slick-carousel-center_inspiration").slick({
    centerMode: true,
    centerPadding: "160px",
    slidesToShow: 3,
    focusOnSelect: true,
    dots: false,
    infinite: true,
    autoplay: false,
    nav: true,
    responsive: [
      {
        breakpoint: 1400,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "70px",
          slidesToShow: 3,
        },
      },

      {
        breakpoint: 1200,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "40px",
          slidesToShow: 2,
        },
      },

      {
        breakpoint: 992,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "185px",
          slidesToShow: 1,
        },
      },

      {
        breakpoint: 768,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "95px",
          slidesToShow: 1,
        },
      },

      {
        breakpoint: 575,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "38px",
          slidesToShow: 1,
        },
      },

      {
        breakpoint: 425,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "12px",
          slidesToShow: 1,
        },
      },

      {
        breakpoint: 375,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "0px",
          slidesToShow: 1,
        },
      },
    ],
  });
});

$(document).ready(function () {
  $(".slick-carousel-center_trending").slick({
    centerMode: true,
    centerPadding: "160px",
    slidesToShow: 3,
    focusOnSelect: true,
    dots: false,
    infinite: true,
    autoplay: true,
    nav: true,
    responsive: [
      {
        breakpoint: 1400,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "72.5px",
          slidesToShow: 3,
        },
      },

      {
        breakpoint: 1200,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "40px",
          slidesToShow: 2,
        },
      },

      {
        breakpoint: 992,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "190px",
          slidesToShow: 1,
        },
      },

      {
        breakpoint: 768,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "95px",
          slidesToShow: 1,
        },
      },

      {
        breakpoint: 575,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "0",
          slidesToShow: 1,
        },
      },
    ],
  });
});

$(document).ready(function () {
  $(".slick-carousel-center_browse").slick({
    centerMode: true,
    centerPadding: "160px",
    slidesToShow: 3,
    focusOnSelect: true,
    dots: false,
    infinite: true,
    autoplay: true,
    nav: true,
    responsive: [
      {
        breakpoint: 1400,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "71px",
          slidesToShow: 3,
        },
      },

      {
        breakpoint: 1200,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "40px",
          slidesToShow: 2,
        },
      },

      {
        breakpoint: 992,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "185px",
          slidesToShow: 1,
        },
      },

      {
        breakpoint: 768,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "95px",
          slidesToShow: 1,
        },
      },

      {
        breakpoint: 575,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "38px",
          slidesToShow: 1,
        },
      },

      {
        breakpoint: 425,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "13px",
          slidesToShow: 1,
        },
      },
    ],
  });
});

$(document).ready(function () {
  $(".slick-carousel-center_blog").slick({
    centerMode: true,
    centerPadding: "160px",
    slidesToShow: 3,
    focusOnSelect: true,
    dots: false,
    infinite: true,
    autoplay: true,
    nav: true,
    responsive: [
      {
        breakpoint: 1400,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "70px",
          slidesToShow: 3,
        },
      },

      {
        breakpoint: 1200,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "40px",
          slidesToShow: 2,
        },
      },

      {
        breakpoint: 992,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "185px",
          slidesToShow: 1,
        },
      },

      {
        breakpoint: 768,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "95px",
          slidesToShow: 1,
        },
      },

      {
        breakpoint: 575,
        settings: {
          arrows: true,
          centerMode: true,
          centerPadding: "0",
          slidesToShow: 1,
        },
      },
    ],
  });
});

// Variable to keep track of the currently selected link
let currentSelectedLink = null;

// Sample data for each category with multiple items
const categoryData = {
  Ingredients: [
    {
      image: "../assets/images/potato.png",
      title: "Potato",
      text: "257 Recipes",
    },
    {
      image: "../assets/images/tomato.png",
      title: "Tomato",
      text: "257 Recipes",
    },
    {
      image: "../assets/images/onion.png",
      title: "Onion",
      text: "257 Recipes",
    },
    {
      image: "../assets/images/garlic.png",
      title: "Garlic",
      text: "257 Recipes",
    },
    {
      image: "../assets/images/chicken.png",
      title: "Chicken",
      text: "257 Recipes",
    },
    {
      image: "../assets/images/peanuts.png",
      title: "Peanuts",
      text: "257 Recipes",
    },
    {
      image: "../assets/images/garlic.png",
      title: "Garlic",
      text: "257 Recipes",
    },
    {
      image: "../assets/images/chicken.png",
      title: "Butter",
      text: "257 Recipes",
    },
    {
      image: "../assets/images/peanuts.png",
      title: "Milk",
      text: "257 Recipes",
    },
    {
      image: "../assets/images/potato.png",
      title: "Cheese",
      text: "257 Recipes",
    },
    {
      image: "../assets/images/tomato.png",
      title: "Egg",
      text: "257 Recipes",
    },
    {
      image: "../assets/images/onion.png",
      title: "Rice",
      text: "257 Recipes",
    },
    {
      image: "../assets/images/garlic.png",
      title: "Cheese",
      text: "257 Recipes",
    },
    {
      image: "../assets/images/chicken.png",
      title: "Egg",
      text: "257 Recipes",
    },
    {
      image: "../assets/images/peanuts.png",
      title: "Rice",
      text: "257 Recipes",
    },
    {
      image: "../assets/images/potato.png",
      title: "Garlic",
      text: "257 Recipes",
    },
    {
      image: "../assets/images/tomato.png",
      title: "Chicken",
      text: "257 Recipes",
    },
    {
      image: "../assets/images/onion.png",
      title: "Peanuts",
      text: "257 Recipes",
    },
  ],
  Meals: [
    {
      image: "../assets/images/breakFast.jpg",
      title: "Break Fast",
      text: "123 recipes",
      btn: "View all Break Fast Recipes",
    },
    {
      image: "../assets/images/breakFast.jpg",
      title: "Lunch",
      text: "123 recipes",
      btn: "View all Lunch Recipes",
    },
    {
      image: "../assets/images/breakFast.jpg",
      title: "Snacks",
      text: "123 recipes",
      btn: "View all Snacks Recipes",
    },
    {
      image: "../assets/images/breakFast.jpg",
      title: "Dinner",
      text: "Description for Ingredient 1",
      btn: "View all Dinner Recipes",
    },
    {
      image: "../assets/images/breakFast.jpg",
      title: "Brunch",
      text: "123 recipes",
      btn: "View all Brunch Recipes",
    },
    {
      image: "../assets/images/breakFast.jpg",
      title: "Shakes & Drinks",
      text: "123 recipes",
      btn: "View all Shakes & Drinks Recipes",
    },
    {
      image: "../assets/images/breakFast.jpg",
      title: "Appetizers",
      text: "123 recipes",
      btn: "View all Appetizers Recipes",
    },
    {
      image: "../assets/images/breakFast.jpg",
      title: "Desserts",
      text: "123 recipes",
      btn: "View all Desserts Recipes",
    },
    {
      image: "../assets/images/breakFast.jpg",
      title: "Side Dishes",
      text: "123 recipes",
      btn: "View all Side Dishes Recipes",
    },
  ],
};

// Select all links with the class 'category-link'
const categoryLinks = document.querySelectorAll(".category-link");

// Function to display cards for a given category
function displayCategory(category) {
  // Get the container where the new section will be added
  const itemsSectionContainer = document.getElementById(
    "items-section-container"
  );

  // Clear the existing content in the container
  itemsSectionContainer.innerHTML = "";

  // Get the data for the selected category
  const data = categoryData[category];

  // Create a single row container div
  const row = document.createElement("div");
  row.className = "row";
  itemsSectionContainer.appendChild(row);

  // Define the number of columns based on the category
  let numColumns = category === "Ingredients" ? 6 : 3;

  // Update the count and name of items found
  const searchText = document.querySelector(".search-text");
  searchText.textContent = `${data.length} ${category} types found`; // Update text content

  // Update search input placeholder based on category
  const searchInput = document.querySelector(".form-control");
  searchInput.placeholder = `Search type of ${category}`;

  // Iterate through the data and create a card for each item
  data.forEach((item) => {
    // Create the card element
    const card = document.createElement("div");
    card.className = `col-lg-${12 / numColumns} mb-4 position-relative
    ${category === "Meals" ? "col-lg-4 col-sm-6 col-12" : ""}
    ${
      category === "Ingredients"
        ? "col-xl-2 col-lg-3 col-md-4 col-sm-6 col-12 justify-content-center d-flex justify-content-sm-start d-sm-block"
        : ""
    }`; // Adjusting column width based on the number of columns
    card.innerHTML = `
            <div class="card ${
              category === "Ingredients" ? "text-center" : ""
            }">
                <img src="${item.image}" class="card-img-top ${
      category === "Ingredients" ? "ingredients-img" : ""
    }" alt="${item.title}">
                ${
                  category === "Ingredients"
                    ? `
                      <input type="checkbox" class="position-absolute top-0 end-0 mt-2 me-2 card-checkbox" id="${item.title}" name="meals" value="${item.title}">
                    `
                    : ""
                }
                <div class="card-body">
                    <h5 class="card-title">${item.title}</h5>
                    <p class="card-text">${item.text}</p>
                    ${
                      category === "Meals"
                        ? `
                    <div className="ingredient-card_btn">
                      <a href="#" class="btn btn-danger w-100">${item.btn}</a>
                    </div>
                    `
                        : ""
                    }
                </div>
            </div>
          `;

    // Add click event listener to the card to toggle the checkbox
    if (category === "Ingredients") {
      card.addEventListener("click", (event) => {
        // Check if the click target is not the checkbox itself
        if (!event.target.classList.contains("card-checkbox")) {
          const checkbox = card.querySelector(".card-checkbox");
          checkbox.checked = !checkbox.checked;
        }
      });

      // Add event listener to the checkbox to stop propagation
      const checkbox = card.querySelector(".card-checkbox");
      checkbox.addEventListener("click", (event) => {
        event.stopPropagation();
      });
    }

    // Append the card to the current row
    row.appendChild(card);
  });
  // Add the "Show Recipes" button outside the loop for Ingredients section
  if (category === "Ingredients") {
    const mealsSectionBtnContainer = document.createElement("div");
    mealsSectionBtnContainer.className =
      "col-12 meals-section_btn mt-5 mb-4 text-center";
    mealsSectionBtnContainer.innerHTML = `
      <a href="#" class="btn btn-danger" style="width: 192px;">Show Recipes (${data.length})</a>
    `;
    itemsSectionContainer.appendChild(mealsSectionBtnContainer);
  }
}

// Add a click event listener to each link
categoryLinks.forEach((link) => {
  link.addEventListener("click", function (event) {
    // Prevent the default action
    event.preventDefault();

    // Reset the background color of the previously selected link
    if (currentSelectedLink) {
      currentSelectedLink.style.backgroundColor = "#fff";
    }

    // Set the background color of the clicked link
    this.style.backgroundColor = "#e05865";

    // Update the current selected link
    currentSelectedLink = this;

    // Get the category from the data attribute
    const category = this.getAttribute("data-category");

    // Display the category
    displayCategory(category);
  });
});

// Display the "Ingredients" category by default
document.addEventListener("DOMContentLoaded", () => {
  const defaultCategory = document.querySelector(
    '.category-link[data-category="Ingredients"]'
  );
  if (defaultCategory) {
    defaultCategory.style.backgroundColor = "#e05865";
    currentSelectedLink = defaultCategory;
    displayCategory("Ingredients");
  }
});

// JS for login page and sesssion handling
document
  .getElementById("login_form")
  .addEventListener("submit", function (event) {
    event.preventDefault();
    login();
  });

function login() {
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;

  // Construct the URL with query parameters
  const url = `https://recipe.edevz.com/client/api/login.php?email=${encodeURIComponent(
    email
  )}&password=${encodeURIComponent(password)}`;

  fetch(url, {
    method: "GET",
    headers: {
      "Content-Type": "application/json",
    },
  })
    .then((response) => response.json())
    .then((data) => {
      console.log("Response:", data); // Log the response from the server
      if (data.success) {
        console.log("success");
        console.log("success");
        // Save user information in session storage
        sessionStorage.setItem("userId", data.user.user_id);
        sessionStorage.setItem("userName", data.user.name);
        sessionStorage.setItem("isLoggedIn", true);

        // $("#loginButton").addClass("d-none");
        // $("#profile-dropdown").removeClass("d-none");
        // Update the UI to show the profile dropdown and hide the login button
        // document.getElementById("loginButton").style.display = "none";
        // document.getElementById("profile-dropdown").style.display = "block";
        // Redirect to the homepage (index.php)
        window.location.href = "index.php";
      } else {
        document.getElementById("responseMessage").textContent =
          "Login Failed!";
      }
    })
    .catch((error) => {
      console.error("Error:", error);
      document.getElementById("responseMessage").textContent =
        "An error occurred. Please try again later.";
    });
}

// function checkLoginSession() {
//   fetch("https://recipe.edevz.com/client/api/checkLoginSession.php")
//     .then((response) => response.json())
//     .then((data) => {
//       if (data.logged_in) {
//         // User is logged in, update the navbar accordingly
//         document.getElementById("loginButton").style.display = "none";
//         document.getElementById("profile-dropdown").style.display = "block";
//         document.getElementById("profileName").textContent = data.user_name;
//       } else {
//         // User is not logged in, show the login button
//         document.getElementById("loginButton").style.display = "block";
//         document.getElementById("profile-dropdown").style.display = "none";
//       }
//     })
//     .catch((error) => console.error("Error checking login session:", error));
// }

// // Call this function on page load
// document.addEventListener("DOMContentLoaded", checkLoginSession);
